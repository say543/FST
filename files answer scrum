
files domain 怎麼onbaord 到evaluation
https://msasg.visualstudio.com/Cortana/_git/CoreScienceDataStaging/pullrequest/1182483?_a=files
看這個pr

================
memory evaluation
==================

0719 first model
E:\CoreScienceDataStaging\datasources\Files\queryclassificationprocessing> .\QCSQueryLabelWithLES.exe --externalFeaturesColumn 2 --queryInColumn 1 --interactive --verbose --encoding utf-8 --legacyAllowUnusedParameters -c E:\searchgold\deploy\builds\data\answers\QasBatWStatic  --variant files_enus_mv1 -dl files



	Line 30: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E15677D8EB" String1="Memory delta for component files_enus_mv1::qd_files_preprocess_featurizer is 320 Kb; time delta is 14.349 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 33: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156795E55" String1="Memory delta for component files_enus_mv1::qd_files_domain_featurizer is 372 Kb; time delta is 6.641 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 41: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E1567C4285" String1="Memory delta for component files_enus_mv1::qd_files_intent_featurizer is 8 Kb; time delta is 6.645 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 45: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E1567EC62F" String1="Memory delta for component files_enus_mv1::qd_files_slot_featurizer is 8208 Kb; time delta is 8.839 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 52: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156815C72" String1="Memory delta for component files_enus_mv1::qd_files_slot_partial_pattern_featurizer is 6164 Kb; time delta is 7.634 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 55: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156837DDA" String1="Memory delta for component files_enus_mv1::qd_files_timeresolution_featurizer is 16424 Kb; time delta is 5.059 ms. Type is MLG34PipelineFeaturizer. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 57: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E15683F2C2" String1="Memory delta for component files_enus_mv1::qd_files_domainclassifier is 0 Kb; time delta is 0.062 ms. Type is MLG34DomainClassifier. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 59: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156848EC0" String1="Memory delta for component files_enus_mv1::qd_files_queryparser is 0 Kb; time delta is 1.125 ms. Type is MLG34CrfQueryParser. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 61: i,08/14/2019 13:46:24,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156855163" String1="Memory delta for component files_enus_mv1::qd_files_entityextractor is 4 Kb; time delta is 0.095 ms. Type is TokenEntityExtractorImpl. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 63: i,08/14/2019 13:46:25,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E156864F0B" String1="Memory delta for component files_enus_mv1::qd_files_domaintaxonomy is 0 Kb; time delta is 4.481 ms. Type is MLG34DomainTaxonomyClassifier. Memory and time reporting are non-reliable because of asynchronous initialization."
	Line 65: i,08/14/2019 13:46:25,QCS,,SrcFile="QCSAutopilotLog" SrcFunc="QCSComponentManager" SrcLine="0" Pid="28680" Tid="19400" TS="0x01D552E15687D489" String1="Memory delta for component files_enus_mv1::qd_files_timeresolution_metadataretriever is 4 Kb; time delta is 5.685 ms. Type is ExposeFeatureMetadataRetrieverImpl. Memory and time reporting are non-reliable because of asynchronous initialization."

around 40MB


=================
medadata
=================


=================
knowledge from teams
================
[10:27 AM] Yue Ma
    
https://msasg.visualstudio.com/Cortana/_git/CoreScienceDataStaging?path=%2Fmodels%2Fteams%2Fluna_teams_slots.canonicalentities.file_filetype.txt&version=GBmaster => will keep the same canonical mapping in new domain

==============
items
===============

3s search
   need to find out what tests available?
   for golden sets
Scenarios tests
Integration Tests
FrisBee Test ( only for cortana)




how to sync with skill teams regularly?
    pretty hard
    
    
 scenarios is more detailed compared to intent
 one intent will have differene scenarios


07312019
swtich from CLU.core.1.2.286 to 1.2.305 for training 看看


================
07302019
files schema 跟team schema 討論
================


intent level 

1. file navigation intent
instance1 (for teams) for teams 這個部分 file_search mpa 回去file_navitation
    要考慮會不會產生overtrigged
instance2 (for 3s answer) 這個部分  file_search 還是file_search


<discuss>
跟skill teams 的討論  感覺不太care 是不是navigation intent, file search ?


show me my recent files / show me my files
show me files i was working on 
只用slot 無法分辨
一定要file navigate  有沒有slot 無關

but 
open the files I recently worked on
這個是file_open (在) spec 但是也需要 slot


所以需要maintain 兩個intent
slots 就用 file_recency (要不要包含I 再說) 跟file_action



  <action_item>
       teams_intent_training_after_filter.py done
       E:\fileAnswer_data_synthesis\CMF_training\resource\intents.txt 加intent



slot level

2. file_filerecency
   slot 變成 file_recency
   目前plan 用files 的file_action  (雖然只tag action, not i was)
    把一些特別的verb 轉成要求的file_recency 的canonical value
    來support 
    
    
3.1 file_sharetarget
   instance1 (for teams) for teams 這個部分 會expose for cortana skill team
   instance2 (for 3s answer)  這個tag 會被移除
   p.s 兩個physical instatnce 會有不同的featurier

<discuss>
    覺得file_sharetarget 要新加
    person 除非用canonical value 來tell 否則很難
    其他的很難train 我覺得


3.2 teammeeting_title
   instance1 (for teams) for teams 這個部分 會expose for cortana skill team
   instance2 (for 3s answer)  這個tag 會被移除
   p.s 兩個physical instatnce 會有不同的featurier

<discuss>
    覺得teammeeting_title 要新加
   
4. file_search
    直接給teams 同name
  
5. file_name or file_keyword
    直接給teams 同name
    
6. start_time
    直接給teams 同name
7.file_type
    直接給
    
   
   
目前剩下的issue
 1> two start_date  or start time issue  
 open the <?>last week<?> file i edited yesterday
 we can tag two start date 但是不知道skill teams 怎麼處理
  
  what are <file_keyword> last weeks tasks </file_keyword>
  find <file_type> note </file_type> from <start_date> last week </start_date> <file_keyword> to do ' s </file_keyword>
  <start_date> last week </start_date> ' s <file_type> notes </file_type>.
  
  yong : 這個先不管 丟給partner teams 
  要嘛只tag 一個 or  tag 2 個 但是先不管skill teams 會怎麼動
 2> 
 open the file <cnotact>A shares to me 
 open the file i share to susan
 
 if we need to differentaite, we might need to add two like from_contact_name and contact name.
 
 yong:
 加兩個slot 然後兩個都tag
   實際的my stuff data 兩個都存在
  
  
  <action_item>
       files_mystuff_after_filter.done
       
       用contact_name 跟to_contact_name
       這樣to_contact_name 基本都是i
       contact_name 有i 也一堆沒有i 的
       
       teams 的在說
       E:\fileAnswer_data_synthesis\CMF_training\resource\slots.txt 
       先加slots
       lexicons 的部分
       E:\fileAnswer_data_synthesis\CMF_training\resource\LexiconFiles\slots.lexicon.desc.txt
       把contact_name 跟to_contact_name 用不同lexciocn name 但是content 依樣
       contact_name:Trie(.\resource\LexiconFiles\contact_name.txt)
       tp_contact_name:Trie(.\resource\LexiconFiles\to_contact__name.txt)
       p.s 現在兩個裡面都沒有i (contact_name) and me(to_contact_name) 
       ? 可以之後考慮要不要加
       
       
       
      
       
       
       
   
  
 
 
  3>
  timeX issues
  
  yong:
  讓partner teams 去決定
  


 4>
  training issue
  <file_action>
  open photos
  show me a picture of one hundred and seven
  ? open / show  tagged as file_action  這個之後要討論一下  覺得不用tag
  work on 覺得只tag work 比較好  schema 要跟著調整
  my recent downloads
  ? downloads 不知道要不要tag
  
  
  titled <title> christmas list </title>
  titled 先 不tag file action
  
  <start_time>
  ? recent 藥用start time or file_recency  
  目前把recent / recently  大小寫都變成order_ref
  因為order_ref 要用來代替teams 裡面的 file_recency
  靠canonical value 來給
  
   
  find the task note i created last week  沒學好  要找找


  <order_ref>
   要保留
  因為order_ref 要用來代替teams 裡面的 file_recency
  
  
  <file_name>
     沒有足夠的examples
     
     grocery list
     grocery 不是title 要轉乘keyword
     grocery list -> keyword -> file_keyword
     
     christmas list
     不是title 要轉乘keyword
     christmas list -> keyword -> file_keyword
     
     除非有title
     titled <keyword> christmas list </keyword>
     christmas list title -> file_name
     
     say hey cortana show me my task list
     tasl list -> keyword -> file_keyword
     
     find me my music list
     music list -> keyword -> file_keyword
     
     <keyword> music </keyword> <data_type> playlist </data_type>
     music playlist -> keyword -> file_keyword
  
  
     <title> shopping list </title>
      shopping list -> keyword -> file_keyword
      
      
      watch list
      music playlist -> keyword -> file_keyword
      
      walmart list
      walmart playlist -> keyword -> file_keyword
      
      ideas list
      
      
      ? named  something 
      look for he photos named " christmas
      先把它當成 title -> file_name 
      
      
      ? marked 要討論後面是file name or file type
      目前把called , titled 當作file_name
      現在先不管
      
  <file_keyword>
  
     因為list 在 file 不是tpye 
  
     what is on my <title> to-do </title> <data_type> list </data_type> ?
     這to-do list 都轉成keyword  -> file_keyword 因為沒有.doc
     
     
     show me my to do list
     to do list 要轉乘file_keyword
     
     what is in my shopping list
     shopping list 改成file_keyword
     
     <keyword> shopping </keyword> <data_type> list </data_type>
     
     find my <data_source> downloads </data_source>
     teams 裡面是data_type 但是這個file navigation 會給teams 
     怎麼tag 沒差  把她轉成file_keyword     
     
     
     what is in my <title> shopping list </title> ?
     shopping list 變成 keyword -> file keywrod
     
     
     // old 先不管
     team  不懂
     what is in my <keyword> shopping </keyword> <data_type> list </data_type> ?
     
     發現有data type 前面是keyword 比較難train 可以之後調整...


     where is my <data_type> music </data_type> library
     team  不懂
     music library 因該要轉成keyword
     
     <data_type> music </data_type> library
     
     
     mystuff	looking for my <keyword> resume </keyword> , <title> resumecurrent </title> .
     resume 因該什麼也不是
     resumecurrent  -> keyword -> file_keyword
     
     find the <data_type> note </data_type> with my <title> to - do list </title> .
     <title> to - do list </title> 轉成  keyword  -> file_keyword
     
     
     find my pictures from italy
     italy 變成keyword  -> file_keyword
     
     <data_type> visio diagrams </data_type>
     變成keyword  -> file_keyword
     
     windows 10 technical preview doc
     windows 10 technical preview -> k -> f
     
     ? search for justin and ashley in my files
     justin and ashley不確定要不要合併
     先consistent合併
     
     Find my <keyword> homework for tomorrow </keyword> .
     先把tomorrow
     
     <keyword> two thousand fourteen </keyword>
     ? 很難說是date or file key word 先不管
     有這個query 得先拿掉
     
     
     有query 是
     Open my <file_keyword> that I created </file_keyword> 
     會影響created 的traningi 目前沒有好的方法
     
     letters i wrote
     
     有query 是
     <file_keyword> a </file_keyword>
     會影響file_keyword 的  精確度
       
       
  <file_type>
     go to my <data_source> documents </data_source
     teams 是file navagate 沒有tag documents
     先都轉成data type
     
     take me to <data_source> documents </data_source>
     teams 不懂
     先都轉成data type
     
     show me my <keyword> lists </keyword>
     keyword 都轉成data_type
     teams 沒behavior
     
     
     
     
     show me the documents with <keyword> headache </keyword> in the title
     documents -> data_type -> file_type
     
     
   
     <data_type> documents </data_type>
     <data_type> document </data_type>
     documents 先不tag by Ling
     
     <data_type> docs </data_type>
     <data_type> doc </data_type>
     doc 先不tag by Ling
     
     
     ? notes 要不要之後看
     ? presentation 要不要之後看
     ? power point presentation
     ? photos
     ? pictures
     ? picture
     ? text
     ? list
     ? music 
     ? spec file type
     
     
  
   <data_source>
     what is in my <data_source> music file </data_source> 
     music 因該要是file key word
     teams 沒behavior

     <data_type> onenote </data_type>
     onenote 因該是 data_source
     8/7/2019 討論
     ? 需要offline discussion
     
     <data_source> notes </data_source>
     <data_source> note </data_source>
     notes 不是data source
     
     ?notepad 算不算
     
     
     ?excel 是不是data source
     
     Check <data_source> my documents </data_source>
     ? my document 因該不是data source 之後再改
     
   <contact name>
      mystuff	i want to see the <data_type> note </data_type> for <keyword> wendy ' s </keyword>
      ? wendy 不是人名  先不管  因為小寫
      
      
      find pictures of my wife
      ?  my wife 如果有my wife , my something 都先skip
      
      mystuff	<data_type> pictures </data_type> of <keyword> me when i was a baby </keyword>
      
      ? 這個case i 未必是cohtact name
      先skip
      
      
      show my pictures of sunset from kim
      ? 這個my 不知道是不是to_contact_name 先skip
      
      
   <file_recency>
      Show me the files that I was only using
      ? only 先不tag
      
   mystuff 相關
      give me my <keyword> copied </keyword> files
      ? 先把這個copied 轉成 file_actioned
      還不確定
      
      i created 
      
      
      Can you open my "I was working on recently" file for me
      ? 這個query 到底是要把整個變成 key word or 分成file keyword 跟
      
      i created 
      ? 這個query 也有相關的問題
      
      <order_ref> first </order_ref>
      first 因該要是position_ref 不是order_ref
      ? 目前先這樣寫到guideline 以後再說
      
      
      
      last night
      my stuff 是start_time
      calendar 是start_date
      ? 先follow calendar 當作start_date
   
   teams 相關
     cortana find my <order_ref> most recent </order_ref> <keyword> downloads </keyword>
     要轉成file_recency 
     downloads -> data_type -> file_type
     
     find me <quantifier> all </quantifier> documents
     documents -> data_type -> file_type

     where are my downloads
     downloads -> data_type-> file_type
     
     
     
     
     find downloads / open downloads
     teams no action 
     先把downloads 當成keywords -> file_keyword
     
     find my downloads
     teams 有action 但是覺得不合理
     先把downloads 當成keywords -> file_keyword
     
     where can i find my latest downloads
     
     check my downloads
     teams no action 
     先把downloads 當成keywords -> file_keyword
     
    
     pull up my <data_source> downloads </data_source>
     teams 到download 只好變成data_type 
     
     downloads -> data_type-> file_type
     
     
     take me to my downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type
     
     take me to downloads
     teams 到download 只好變成data_type 
     
     downloads -> data_type-> file_type
     
     go to my downloads
     downloads -> data_type-> file_type
     
     view downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type  
     
     view my most recent downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type  

     
     i'm looking for my latest downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type  
     
     bring up my downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type  
     
     show me downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type 
     
     show me all my downloads
     
     show me my <start_time> recent </start_time> downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type   
    
     tell me my downloads
     teams 到download 只好變成data_type 
     downloads -> data_type-> file_type
     
     pull up all my downloads
     
     <meeting_starttime>
     ? 這個是可能可以改的  但是不確定前先不改成這樣
     my stuff
     what are the notes from today ' s meeting
     today 變成meeting_starttime
     meeting sharetarget_type
====================
work konwledge
===================



可能的directory
E:\searchgold\deploy\builds\data\answers\QasBatWStatic
E:\searchgold\deploy\builds\data\answers\QasBatWStatic


可能的command



my stuff for reference
PS E:\CoreScienceDataStaging\datasources\Email_my_temporary\queryclassificationprocessing> .\QCSQueryLabelWithLES.exe --externalFeaturesColumn 2 --queryInColumn 1 --interactive --verbose --encoding utf-8 --legacyAllowUnusedParameters -c E:\SearchGold\deploy\builds\data\answers\QAS12HttpQAS  --variant cortana_mystuff_enus_mv5 -dl mystuff


email for reference
PS E:\CoreScienceDataStaging\datasources\Email_my_temporary\queryclassificationprocessing> .\QCSQueryLabelWithLES.exe --externalFeaturesColumn 2 --queryInColumn 1 --interactive --verbose --encoding utf-8 --legacyAllowUnusedParameters -c E:\SearchGold\deploy\builds\data\answers\QAS12HttpQAS  --variant email_enus_MV1b -dl email


teams for reference
PS E:\CoreScienceDataStaging\datasources\Teams\queryclassificationprocessing> .\QCSQueryLabelWithLES.exe --externalFeaturesColumn 2 --interactive --verbose --encoding utf-8 --legacyAllowUnusedParameters -c E:\CoreScienceDataStaging\target\distrib\Debug\AnyCPU\models  --variant HttpQASINT_ML_OFFLINE_QAS_EVAL_INT.QAS01HttpQAS -d teams


files for reference
PS E:\CoreScienceDataStaging\datasources\Files\queryclassificationprocessing> .\QCSQueryLabelWithLES.exe --externalFeaturesColumn 2 --queryInColumn 1 --interactive --verbose --encoding utf-8 --legacyAllowUnusedParameters -c E:\CoreScienceDataStaging\models\files  --variant files_enus_mv1 -dl files


fst file
PS E:\CoreScienceDataStaging\datasources\Files\resources\infiles> .\fst.exe -l .\slot.fst.partial.infile



如果不確定  在qp 看一下怎麼handle start time  / time slot 


directory
store single models
E:\CoreScienceDataStaging\models\file

do query processing analysis
PS E:\CoreScienceDataStaging\datasources\File\queryclassificationprocessing>

file requirement
https://microsoft.sharepoint.com/:w:/t/STCISearch/EaBGV9tupU1PmE29wtUY6lsBqveJnS9-utZtQ8TFExpihQ?e=W1Uue8


原始doucment
https://microsoft-my.sharepoint-df.com/:w:/p/yum/ERiEN4JphLNMgmNPr8ZUI2oBfNz5tleqQOFnMocgljoycw?rtime=-i-wKDYK10g


自己的comment
https://microsoft-my.sharepoint-df.com/:w:/r/personal/chiecha_microsoft_com/_layouts/15/Doc.aspx?sourcedoc=%7BFFA3E814-A82C-419B-9F83-117766DFC20A%7D&file=Document%201.docx&action=editnew&mobileredirect=true




=====================
domian pattern 打算  07252019
=====================
from teams domain pattern
[qd_teams_domain_fst_lang_model_featurizer]
negative patterns 這個

file_open -> FileOpenNegativeDomain
這個可能要加進來
這個是contextual negalive tlist 
read text ../lexicons/contextual_negative_list.txt;
define ContextualFileOpenEntity;
之後migrate contextual lu 可能需要有他來用

[qd_teams_domain_fst_lang_model_intent_overwrite_featurizer]
positive pattern 的部分
domain.fst_lang_model.tagger.infile

有file_open
file_download -> FileDownloadIntent 可能要家一下

file_navigation 
file_share
teamspace_sharechannel
teamspace_sharetab
    改成 file_share
    可能以後再evaluate 到底需不需要他
teamspace_search
    改成file_search
    
teamspace_navigate
    改成 file_navigate
    可能以後再evaluate 到底需不需要他
    
    
也要加
但是細節上可能要再調整
因為有些case 現在希望是file_search 了  根據files 的guideline
之後再調整


但是這個是沒有domain svm 的情況
可能測試一下是要前面or 後面


[qd_teams_domain_pattern_featurizer]
感覺是另外一個positive pattern 的位置
domain.override.infile

file_open -> FileOpenIntent
這個部分可能要家一下


[qd_teams_common_domain_intent_featurizer]
luna_teams_intents.multiturn
特別處理跟common 的關西避免conflict in teams multi turn
可以先不管  

=====================
intent pattern 打算  07252019
=====================
after svnm


[qd_teams_intents_fst_lang_model_featurizer]
luna_190305_teams.intents.fst_lang_model.INT
intent.fst_lang_model.tagger.infile

這邊沒有必要的intent 不需要 做任何事


[qd_teams_intents_hotfix_featurizer]
luna_181019_teams.intents.hotfix

intent hotfix file
?  以後要hotfix可能需要他
   

=====================
slot pattern 打算  07252019
=====================
after slot lccrf

[qd_teams_slots_fst_lang_model_featurizer]
luna_190118_teams.slots.fst_lang_model
slot.fst_lang_model.tagger.infile
有position Ref 的pattern 但是不是order ref  schema 沒有不需要
